<!doctype html><html lang="es"><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>AGRO – Datos</title>
<script src="https://unpkg.com/papaparse@5.4.1/papaparse.min.js"></script>
<script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
<style>
 body{margin:0;font:14px/1.4 system-ui;background:#f6faf8}
 header{background:#2a7f62;color:#fff;padding:12px 16px} h1{margin:0;font-size:18px}
 main{max-width:1100px;margin:auto;padding:16px}
 .card{background:#fff;border-radius:10px;padding:12px;box-shadow:0 1px 4px rgba(0,0,0,.06)}
 label{font-weight:600;margin-right:6px}
 select,input{padding:8px;border:1px solid #dcdfe3;border-radius:8px}
 table{width:100%;border-collapse:collapse;margin-top:8px;font-size:13px}
 thead th{position:sticky;top:0;background:#eef3f1;text-align:left;padding:6px;border-bottom:1px solid #dce5e0}
 tbody td{padding:6px;border-bottom:1px solid #eef2f0;white-space:nowrap}
 .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
 .small{font-size:12px;color:#666}
</style>
<header><h1>AGRO – Navegador de datos</h1></header>
<main class="card">
  <div class="row">
    <label>Archivo</label>
    <select id="file"></select>
    <label>Buscar</label>
    <input id="q" placeholder="texto…">
    <span id="status" class="small">Elegí un archivo</span>
  </div>
  <div style="overflow:auto;max-height:70vh;border:1px solid #eef2f0;border-radius:10px;margin-top:8px">
    <table id="tbl"><thead></thead><tbody></tbody></table>
  </div>
</main>
<script>
/* 1) EDITÁ ESTA LISTA con los nombres REALES que subiste a docs/data/ */
const FILES = [
  {title:"Agricultura – Indicadores (CSV)", url:"data/agricultura_indicadores.csv"},
  {title:"Bovinos – Faena (XLSX)", url:"data/bovinos_faena.xlsx"},
  {title:"Porcinos – Faena (XLSX)", url:"data/porcinos_faena.xlsx"}
];
/* 2) --- No hace falta tocar desde acá --- */
const $file=document.getElementById('file'), $q=document.getElementById('q');
const $thead=document.querySelector('#tbl thead'), $tbody=document.querySelector('#tbl tbody');
const $status=document.getElementById('status'); let rows=[], cols=[], filtered=[];
$file.innerHTML = FILES.map((f,i)=>`<option value="${i}">${f.title}</option>`).join('');
$file.addEventListener('change',()=>load(FILES[$file.value].url));
$q.addEventListener('input',()=>{ const s=($q.value||'').toLowerCase().trim();
  filtered = !s ? rows : rows.filter(r=>Object.values(r).some(v=>String(v).toLowerCase().includes(s)));
  render();
});
function fmt(n){const v=Number(n);return Number.isFinite(v)?v.toLocaleString('es-AR'):n;}
function render(){
  $thead.innerHTML='<tr>'+cols.map(c=>`<th>${c}</th>`).join('')+'</tr>';
  $tbody.innerHTML=filtered.map(r=>'<tr>'+cols.map(c=>{
    const v=r[c]; return `<td>${(String(v).length<16 && !isNaN(v))?fmt(v):(v??'')}</td>`;
  }).join('')+'</tr>').join('');
  $status.textContent=`Filas: ${filtered.length.toLocaleString('es-AR')} • Columnas: ${cols.length}`;
}
async function load(url){
  $status.textContent='Cargando…'; rows=[]; cols=[]; filtered=[]; render();
  if(url.toLowerCase().endsWith('.csv')){
    const parsed = await new Promise((ok,err)=>Papa.parse(url,{download:true,header:true,dynamicTyping:true,skipEmptyLines:true,complete:ok,error:err}));
    rows=parsed.data||[]; cols=parsed.meta?.fields||Object.keys(rows[0]||{});
  }else{ // xlsx
    const res=await fetch(url), buf=await res.arrayBuffer();
    const wb=XLSX.read(buf,{type:'array'}), sh=wb.Sheets[wb.SheetNames[0]];
    rows=XLSX.utils.sheet_to_json(sh,{defval:''}); cols=Object.keys(rows[0]||{});
  }
  filtered=rows; render();
}
if(FILES.length){ $file.value=0; load(FILES[0].url); }
</script>
