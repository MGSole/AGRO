<!doctype html><html lang="es"><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>AGRO – Datos con menú</title>
<link rel="preconnect" href="https://unpkg.com">
<script src="https://unpkg.com/papaparse@5.4.1/papaparse.min.js"></script>
<script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
<style>
  :root{--bg:#f6faf8;--card:#fff;--accent:#2a7f62;--muted:#667085}
  *{box-sizing:border-box} body{margin:0;font:14px/1.4 system-ui,Segoe UI,Roboto,Arial;background:var(--bg)}
  header{background:var(--accent);color:#fff;padding:12px 16px} header h1{margin:0;font-size:18px}
  .wrap{max-width:1200px;margin:auto;padding:16px;display:grid;gap:16px;grid-template-columns:280px 1fr}
  .card{background:var(--card);border-radius:12px;box-shadow:0 1px 4px rgba(0,0,0,.06)}
  .p16{padding:16px}
  /* Menú */
  aside details{border:1px solid #e6ebe8;border-radius:10px;margin-bottom:10px;background:#fff}
  aside summary{cursor:pointer;list-style:none;padding:10px 12px;font-weight:700}
  aside summary::-webkit-details-marker{display:none}
  .submenu{display:block;width:100%;text-align:left;background:transparent;border:0;border-top:1px solid #eef2f0;padding:10px 12px;cursor:pointer}
  .submenu:hover{background:#f2f7f5}
  .submenu.active{background:#e5f3ee}
  /* Panel derecho */
  .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
  label{font-weight:600;margin-right:6px}
  select,input{padding:8px;border:1px solid #dcdfe3;border-radius:8px;background:#fff}
  .btn{border:1px solid #dcdfe3;background:#fff;padding:8px 12px;border-radius:8px;cursor:pointer;text-decoration:none;color:#000}
  .small{font-size:12px;color:var(--muted)}
  table{width:100%;border-collapse:collapse;font-size:13px}
  thead th{position:sticky;top:0;background:#eef3f1;text-align:left;padding:6px;border-bottom:1px solid #dce5e0}
  tbody td{padding:6px;border-bottom:1px solid #eef2f0;white-space:nowrap}
  .tableWrap{overflow:auto;max-height:70vh;border:1px solid #eef2f0;border-radius:10px;margin-top:8px}
  @media (max-width:900px){.wrap{grid-template-columns:1fr}}
</style>
<header><h1>AGRO – Navegador de datos</h1></header>
<div class="wrap">

  <!-- ===== Menú desplegable con submenús ===== -->
  <aside class="card p16" id="menu">
    <details open>
      <summary>Agricultura</summary>
      <button class="submenu" data-cat="Agricultura" data-sub="1 Producción">1 Producción</button>
      <button class="submenu" data-cat="Agricultura" data-sub="2 Existencias">2 Existencias</button>
      <button class="submenu" data-cat="Agricultura" data-sub="3 Agroprocesamiento">3 Agroprocesamiento</button>
      <button class="submenu" data-cat="Agricultura" data-sub="4 Precios">4 Precios</button>
      <button class="submenu" data-cat="Agricultura" data-sub="5 Comercialización">5 Comercialización</button>
    </details>

    <details>
      <summary>Ganadería</summary>
      <button class="submenu" data-cat="Ganadería" data-sub="1 Producción">1 Producción</button>
      <button class="submenu" data-cat="Ganadería" data-sub="2 Existencias">2 Existencias</button>
      <button class="submenu" data-cat="Ganadería" data-sub="3 Agroprocesamiento">3 Agroprocesamiento</button>
      <button class="submenu" data-cat="Ganadería" data-sub="4 Precios">4 Precios</button>
      <button class="submenu" data-cat="Ganadería" data-sub="5 Comercialización">5 Comercialización</button>
    </details>
  </aside>

  <!-- ===== Panel de datasets + tabla ===== -->
  <main class="card p16">
    <div class="row">
      <label>Dataset</label>
      <select id="dataset"></select>
      <span id="meta" class="small"></span>
    </div>

    <div class="row" style="margin-top:8px">
      <label>Buscar</label>
      <input id="q" placeholder="texto…">

      <!-- NUEVO: acciones -->
      <a id="open" class="btn" target="_blank" rel="noopener">Ver original</a>
      <a id="dl" class="btn">Descargar original</a>
      <button id="dlFiltered" class="btn">Descargar recorte (CSV)</button>

      <span id="status" class="small">Elegí un submenú para listar datasets.</span>
    </div>

    <div class="tableWrap">
      <table id="tbl"><thead></thead><tbody></tbody></table>
    </div>
  </main>
</div>

<script>
/* ===================== 1) CATÁLOGO =====================
   Editá SOLO las URLs/títulos para que coincidan con tus archivos en docs/data/.
   Si tus nombres tienen espacios/acentos, mejor renombrarlos o URL-codificarlos.
*/
const CATALOG = {
  "Agricultura": {
    "1 Producción": [
      { title: "Indicadores por cultivo y provincia (XLSX)", url: "docs/data/Agricultura_indicadores_produccion.xlsx", note: "Área sembrada, cosechada, rendimiento y producción." }
    ], 
    "2 Existencias": [
      { title: "Existencias agrícolas (XLSX)", url: "data/agricultura_existencias.xlsx" }
    ],
    "3 Agroprocesamiento": [
      { title: "Agroprocesamiento (CSV)", url: "data/agroprocesamiento.csv" }
    ],
    "4 Precios": [
      { title: "Precios agrícolas (XLSX)", url: "data/precios_agricultura.xlsx" }
    ],
    "5 Comercialización": [
      { title: "Comercialización (CSV)", url: "data/comercializacion_agricultura.csv" }
    ]
  },
  "Ganadería": {
    "1 Producción": [
      { title: "Bovinos – Faena y producción (XLSX)", url: "data/Bovinos_faena_produccion.xlsx" }
    ],
    "2 Existencias": [
      { title: "Existencias ganaderas (CSV)", url: "data/existencias_ganaderas.csv" }
    ],
    "3 Agroprocesamiento": [
      { title: "Agroprocesamiento cárnico (CSV)", url: "data/agroproc_ganaderia.csv" }
    ],
    "4 Precios": [
      { title: "Precios ganaderos (XLSX)", url: "data/precios_ganaderia.xlsx" }
    ],
    "5 Comercialización": [
      { title: "Comercialización ganadera (CSV)", url: "data/comercializacion_ganaderia.csv" }
